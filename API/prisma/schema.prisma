generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Setor {
  id                     Int                      @id @default(autoincrement())
  nome                   String                   @unique
  HcrAirConditioning     HcrAirConditioning[]
  HcrComputer            HcrComputer[]
  HcrEquipamentosMedicos HcrEquipamentosMedicos[]
  HcrMobilia             HcrMobilia[]
  HcrPrinter             HcrPrinter[]
  localizacoes           Localizacao[]
  os                     OrdemServico[]
}

model Localizacao {
  id      Int    @id @default(autoincrement())
  nome    String @unique
  setor   Setor?  @relation(fields: [setorId], references: [id])
  setorId Int?

  HcrComputer            HcrComputer[]
  HcrPrinter             HcrPrinter[]
  HcrAirConditioning     HcrAirConditioning[]
  HcrComputer            HcrComputer[]
  HcrEquipamentosMedicos HcrEquipamentosMedicos[]
  HcrMobilia             HcrMobilia[]
  HcrPrinter             HcrPrinter[]
  setor                  Setor                    @relation(fields: [setorId], references: [id])
}

model Usuario {
  id           Int            @id @default(autoincrement())
  nome         String
  email        String         @unique
  senha        String
  papel        PapelUsuario
  tecnicoId    Int?
  OrdemServico OrdemServico[]
  tecnico      Tecnico?       @relation(fields: [tecnicoId], references: [id])
}

model GrupoManutencao {
  id        Int               @id @default(autoincrement())
  nome      String
  descricao String?
  tecnicos  Tecnico[]
  tipos     TipoEquipamento[]
}

model TipoEquipamento {
  id                     Int                      @id @default(autoincrement())
  nome                   String                   @unique
  grupoId                Int?
  HcrAirConditioning     HcrAirConditioning[]
  HcrComputer            HcrComputer[]
  HcrEquipamentosMedicos HcrEquipamentosMedicos[]
  HcrMobilia             HcrMobilia[]
  HcrPrinter             HcrPrinter[]
  OrdemServico           OrdemServico[]
  grupo                  GrupoManutencao?         @relation(fields: [grupoId], references: [id])
}

model Tecnico {
  id             Int             @id @default(autoincrement())
  nome           String
  email          String          @unique
  telefone       String
  cpf            String?         @unique
  matricula      String?
  admissao       DateTime?
  ativo          Boolean         @default(true)
  telegramChatId String?
  grupoId        Int
  os             OrdemServico[]
  grupo          GrupoManutencao @relation(fields: [grupoId], references: [id])
  Usuario        Usuario[]
}

model OrdemServico {
  id                Int             @id @default(autoincrement())
  descricao         String
  tipoEquipamentoId Int
  equipamentoId     Int
  tecnicoId         Int?
  solicitanteId     Int
  status            StatusOS        @default(ABERTA)
  criadoEm          DateTime        @default(now())
  finalizadoEm      DateTime?
  resolucao         String?
  arquivos          String[]
  preventiva        Boolean         @default(false)
  setorId           Int?
  Setor             Setor?          @relation(fields: [setorId], references: [id])
  solicitante       Usuario         @relation(fields: [solicitanteId], references: [id])
  tecnico           Tecnico?        @relation(fields: [tecnicoId], references: [id])
  tipoEquipamento   TipoEquipamento @relation(fields: [tipoEquipamentoId], references: [id])
}

model HcrComputer {
  id                 Int             @id @default(autoincrement())
  nPatrimonio        String
  nomePC             String
  ip                 String?
  sistemaOperacional String
  tipoEquipamentoId  Int
  localizacaoId      Int
  setorId            Int
  localizacao        Localizacao     @relation(fields: [localizacaoId], references: [id])
  setor              Setor           @relation(fields: [setorId], references: [id])
  tipoEquipamento    TipoEquipamento @relation(fields: [tipoEquipamentoId], references: [id])
}

model HcrPrinter {
  id                Int             @id @default(autoincrement())
  nPatrimonio       String
  ip                String?
  marca             String
  modelo            String
  tipoEquipamentoId Int
  localizacaoId     Int
  setorId           Int
  localizacao       Localizacao     @relation(fields: [localizacaoId], references: [id])
  setor             Setor           @relation(fields: [setorId], references: [id])
  tipoEquipamento   TipoEquipamento @relation(fields: [tipoEquipamentoId], references: [id])
}

model HcrAirConditioning {
  id                Int              @id @default(autoincrement())
  nPatrimonio       String
  nControle         String
  marca             String
  modelo            String
  tipoEquipamentoId Int?
  localizacaoId     Int?
  setorId           Int?
  BTUS              String
  numeroSerie       String?
  obs               String?
  localizacao       Localizacao?     @relation(fields: [localizacaoId], references: [id])
  setor             Setor?           @relation(fields: [setorId], references: [id])
  tipoEquipamento   TipoEquipamento? @relation(fields: [tipoEquipamentoId], references: [id])
}

model HcrMobilia {
  id                Int             @id @default(autoincrement())
  nPatrimonio       String
  nome              String
  tipo              String
  material          String
  estado            String
  obs               String?
  tipoEquipamentoId Int
  localizacaoId     Int
  setorId           Int
  localizacao       Localizacao     @relation(fields: [localizacaoId], references: [id])
  setor             Setor           @relation(fields: [setorId], references: [id])
  tipoEquipamento   TipoEquipamento @relation(fields: [tipoEquipamentoId], references: [id])
}

model HcrEquipamentosMedicos {
  id                Int             @id @default(autoincrement())
  numeroPatrimonio  String
  numeroSerie       String?
  numeroAnvisa      String?
  nomeEquipamento   String
  Identificacao     String?
  modelo            String?
  Fabricante	      String?
  Fornecedor        String?
  valorCompra       Float?
  dataCompra        DateTime?
  inicioGarantia    DateTime?
  terminoGarantia   DateTime?
  notaFiscal        String?
  obs               String?
  setorId           Int
  localizacaoId     Int
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  tipoEquipamentoId Int
  localizacao       Localizacao     @relation(fields: [localizacaoId], references: [id])
  setor             Setor           @relation(fields: [setorId], references: [id])
  tipoEquipamento   TipoEquipamento @relation(fields: [tipoEquipamentoId], references: [id])
}

model HcrEquipamentosMedicos {
  id                 Int             @id @default(autoincrement())
  numeroPatrimonio   String?
  Identificação      String?
  numeroSerie        String?
  numeroAnvisa       String?
  nomeEquipamento    String
  modelo             String?
  Fabricante         String?

  valorCompra        Float?
  dataCompra         DateTime?
  inicioGarantia     DateTime?
  terminoGarantia    DateTime?
  notaFiscal         String?
  obs                String?

  setor              Setor?           @relation(fields: [setorId], references: [id])
  setorId            Int?

  localizacao        Localizacao?     @relation(fields: [localizacaoId], references: [id])
  localizacaoId      Int?

  tipoEquipamento    TipoEquipamento? @relation(fields: [tipoEquipamentoId], references: [id])
  tipoEquipamentoId  Int?

  createdAt          DateTime        @default(now())
  updatedAt          DateTime?       @updatedAt
}
